{
  "version": "2.0.0",
  "tasks": [
    {
      "id": "task-add-user-validation",
      "task": "Add email format validation to the user creation endpoint",
      "category": "add-feature",
      "optimalContext": {
        "requiredFiles": [
          {
            "file": "src/routes/users.ts",
            "relevance": "critical",
            "sections": [{ "startLine": 37, "endLine": 47 }],
            "tokenEstimate": 150
          },
          {
            "file": "src/utils/errors.ts",
            "relevance": "critical",
            "sections": [{ "startLine": 25, "endLine": 32 }],
            "tokenEstimate": 80
          },
          {
            "file": "src/services/userService.ts",
            "relevance": "important",
            "sections": [{ "startLine": 58, "endLine": 70 }],
            "tokenEstimate": 120
          }
        ],
        "requiredPatterns": ["custom-error-class", "crud-route-pattern"],
        "requiredConstraints": ["Use ValidationError for validation failures"],
        "optimalTokens": 350,
        "maxAcceptableTokens": 800
      },
      "noiseFiles": [
        {
          "file": "src/routes/products.ts",
          "reason": "Different resource, not relevant to user validation",
          "temptation": "medium",
          "tokenCost": 400
        },
        {
          "file": "src/routes/orders.ts",
          "reason": "Different resource",
          "temptation": "low",
          "tokenCost": 350
        },
        {
          "file": "src/middleware/logger.ts",
          "reason": "Logging not relevant to validation",
          "temptation": "low",
          "tokenCost": 100
        },
        {
          "file": "src/routes/legacy.ts",
          "reason": "Legacy code should not be used as reference",
          "temptation": "high",
          "tokenCost": 500
        }
      ],
      "difficulty": "easy"
    },
    {
      "id": "task-fix-legacy-auth",
      "task": "Add authentication to all legacy routes that are missing it",
      "category": "security-fix",
      "optimalContext": {
        "requiredFiles": [
          {
            "file": "src/routes/legacy.ts",
            "relevance": "critical",
            "tokenEstimate": 500
          },
          {
            "file": "src/middleware/auth.ts",
            "relevance": "critical",
            "sections": [{ "startLine": 1, "endLine": 50 }],
            "tokenEstimate": 200
          },
          {
            "file": "src/routes/users.ts",
            "relevance": "important",
            "sections": [{ "startLine": 1, "endLine": 25 }],
            "tokenEstimate": 150
          }
        ],
        "requiredPatterns": ["auth-middleware", "crud-route-pattern"],
        "requiredConstraints": ["All mutation endpoints must use authMiddleware"],
        "optimalTokens": 850,
        "maxAcceptableTokens": 1500
      },
      "noiseFiles": [
        {
          "file": "src/services/userService.ts",
          "reason": "Services don't handle auth, routes do",
          "temptation": "medium",
          "tokenCost": 400
        },
        {
          "file": "src/utils/response.ts",
          "reason": "Response helpers not relevant to auth",
          "temptation": "low",
          "tokenCost": 150
        }
      ],
      "difficulty": "medium"
    },
    {
      "id": "task-add-pagination-to-legacy",
      "task": "Add pagination support to the legacy GET /users endpoint",
      "category": "add-feature",
      "optimalContext": {
        "requiredFiles": [
          {
            "file": "src/routes/legacy.ts",
            "relevance": "critical",
            "sections": [{ "startLine": 17, "endLine": 26 }],
            "tokenEstimate": 100
          },
          {
            "file": "src/routes/users.ts",
            "relevance": "critical",
            "sections": [{ "startLine": 19, "endLine": 25 }],
            "tokenEstimate": 80
          },
          {
            "file": "src/utils/response.ts",
            "relevance": "critical",
            "sections": [{ "startLine": 24, "endLine": 38 }],
            "tokenEstimate": 100
          }
        ],
        "requiredPatterns": ["response-helper", "crud-route-pattern"],
        "requiredConstraints": ["Use sendPaginated for paginated responses"],
        "optimalTokens": 280,
        "maxAcceptableTokens": 600
      },
      "noiseFiles": [
        {
          "file": "src/middleware/auth.ts",
          "reason": "Auth not relevant to pagination",
          "temptation": "low",
          "tokenCost": 200
        },
        {
          "file": "src/middleware/errorHandler.ts",
          "reason": "Error handling not relevant to pagination",
          "temptation": "low",
          "tokenCost": 150
        }
      ],
      "difficulty": "easy"
    }
  ],
  "baselines": [
    {
      "name": "naive-grep",
      "strategy": "naive-grep",
      "expectedTokens": 2500,
      "expectedRelevance": 0.4
    },
    {
      "name": "file-tree",
      "strategy": "file-tree",
      "expectedTokens": 3500,
      "expectedRelevance": 0.6
    },
    {
      "name": "all-files",
      "strategy": "all-files",
      "expectedTokens": 5000,
      "expectedRelevance": 1.0
    }
  ]
}
