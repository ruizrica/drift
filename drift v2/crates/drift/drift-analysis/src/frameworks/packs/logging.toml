[framework]
name = "logging-patterns"
display_name = "Logging Patterns"
languages = ["typescript", "javascript", "python", "java", "csharp", "go", "rust", "ruby", "php", "kotlin"]

[[patterns]]
id = "LOG-CORRELATION-001"
category = "logging"
description = "Correlation ID usage"
sub_type = "correlation"
confidence = 0.85
[patterns.match]
content_patterns = [
    "(?i)correlation[_-]?id", "(?i)x-correlation-id",
    "(?i)trace[_-]?id", "(?i)x-trace-id", "(?i)traceparent",
    "(?i)span[_-]?id", "(?i)request[_-]?id", "(?i)x-request-id",
]

[[patterns]]
id = "LOG-STRUCTURED-001"
category = "logging"
description = "Structured logging format"
sub_type = "structured"
confidence = 0.85
[patterns.match]
imports = [
    "winston", "pino", "bunyan", "structlog", "loguru",
    "Serilog", "NLog", "zap", "logrus", "slog",
    "tracing", "flexi_logger",
]
[patterns.learn]
group_by = "sub_type"
signal = "convention"

[[patterns]]
id = "LOG-CONTEXT-001"
category = "logging"
description = "Contextual log fields"
sub_type = "context"
confidence = 0.80
[patterns.match]
content_patterns = [
    "(?i)logger\\.child\\s*\\(", "(?i)log\\.with\\s*\\(",
    "(?i)logger\\.bind\\s*\\(", "(?i)structlog\\.contextvars",
    "(?i)MDC\\.put\\s*\\(", "(?i)LogContext\\.PushProperty",
    "(?i)With\\s*\\(\\s*zap\\.", "(?i)tracing::info_span",
]

[[patterns]]
id = "LOG-PII-001"
category = "logging"
description = "PII redaction in logs"
sub_type = "pii"
confidence = 0.85
cwe_ids = [532]
[patterns.match]
content_patterns = [
    "(?i)redact", "(?i)mask", "(?i)sanitize.*log",
    "(?i)\\[REDACTED\\]", "(?i)\\*\\*\\*\\*",
    "(?i)pii[_-]?filter", "(?i)sensitive[_-]?field",
]
[patterns.match.not]
file_patterns = [
    # Exclude PII pattern definition files â€” they reference PII concepts
    # but are defining detection rules, not logging PII.
    "patterns/", "patterns\\\\",
]

[[patterns]]
id = "LOG-LEVEL-001"
category = "logging"
description = "Log level configuration"
sub_type = "levels"
confidence = 0.75
[patterns.match]
content_patterns = [
    "(?i)log[_-]?level\\s*[=:]", "(?i)LOG_LEVEL",
    "(?i)setLevel\\s*\\(", "(?i)set_level\\s*\\(",
    "(?i)MinimumLevel\\.", "(?i)RUST_LOG",
]
[patterns.learn]
group_by = "sub_type"
signal = "convention"

[[patterns]]
id = "LOG-METRIC-001"
category = "logging"
description = "Metric naming patterns"
sub_type = "metrics"
confidence = 0.80
[patterns.match]
content_patterns = [
    "(?i)(?:counter|gauge|histogram|summary)\\s*\\(",
    "(?i)metrics?\\.(?:increment|decrement|timing|gauge)",
    "(?i)StatsD", "(?i)prometheus", "(?i)datadog",
]

[[patterns]]
id = "LOG-HEALTH-001"
category = "logging"
description = "Health check endpoint"
sub_type = "health"
confidence = 0.85
[patterns.match]
content_patterns = [
    "(?i)/health", "(?i)/healthz", "(?i)/readyz", "(?i)/livez",
    "(?i)health[_-]?check", "(?i)HealthCheck",
]
