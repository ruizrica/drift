[framework]
name = "django"
display_name = "Django"
languages = ["python"]
[[framework.detect_by]]
import = "django"
[[framework.detect_by]]
dependency = "django"

[[patterns]]
id = "django/api/view-class"
category = "api"
description = "Django class-based view"
sub_type = "view-type"
confidence = 0.90
[patterns.match]
extends = ["APIView", "ViewSet", "ModelViewSet", "GenericAPIView", "ListView", "DetailView", "CreateView", "UpdateView", "DeleteView", "TemplateView"]
[patterns.learn]
group_by = "sub_type"
signal = "convention"

[[patterns]]
id = "django/api/function-view"
category = "api"
description = "Django function-based view"
sub_type = "view-type"
confidence = 0.85
[patterns.match]
decorators = ["api_view", "require_http_methods", "login_required"]

[[patterns]]
id = "django/api/url-patterns"
category = "api"
description = "URL routing"
sub_type = "routing"
confidence = 0.85
[patterns.match]
content_patterns = ["(?i)path\\s*\\(\\s*['\"]", "(?i)re_path\\s*\\(", "(?i)include\\s*\\(\\s*['\"]"]

[[patterns]]
id = "django/auth/permission"
category = "auth"
description = "Django permission classes"
sub_type = "permission"
confidence = 0.90
[patterns.match]
content_patterns = [
    "(?i)permission_classes\\s*=\\s*\\[",
    "(?i)IsAuthenticated|IsAdminUser|AllowAny|IsAuthenticatedOrReadOnly",
    "(?i)class\\s+\\w+\\s*\\(\\s*BasePermission\\s*\\)",
]
[patterns.learn]
group_by = "sub_type"
signal = "convention"

[[patterns]]
id = "django/auth/decorator"
category = "auth"
description = "Auth decorators"
sub_type = "auth-decorator"
confidence = 0.85
[patterns.match]
decorators = ["login_required", "permission_required", "user_passes_test"]

[[patterns]]
id = "django/data/model"
category = "data_access"
description = "Django model"
sub_type = "model"
confidence = 0.90
[patterns.match]
extends = ["Model", "models.Model"]

[[patterns]]
id = "django/data/queryset"
category = "data_access"
description = "QuerySet operations"
sub_type = "queryset"
confidence = 0.85
[patterns.match]
content_patterns = [
    "(?i)\\.objects\\.(?:filter|exclude|get|all|create|update|delete|annotate|aggregate|values|order_by)\\s*\\(",
    "(?i)select_related\\s*\\(", "(?i)prefetch_related\\s*\\(",
]

[[patterns]]
id = "django/data/serializer"
category = "data_access"
description = "DRF serializer"
sub_type = "serializer"
confidence = 0.90
[patterns.match]
extends = ["Serializer", "ModelSerializer", "HyperlinkedModelSerializer"]
[patterns.learn]
group_by = "sub_type"
signal = "convention"

[[patterns]]
id = "django/data/migration"
category = "data_access"
description = "Database migration"
sub_type = "migration"
confidence = 0.85
[patterns.match]
extends = ["Migration"]

[[patterns]]
id = "django/config/settings"
category = "config"
description = "Django settings"
sub_type = "settings"
confidence = 0.80
[patterns.match]
content_patterns = ["(?i)DATABASES\\s*=", "(?i)INSTALLED_APPS\\s*=", "(?i)MIDDLEWARE\\s*=", "(?i)django\\.conf\\s+import\\s+settings"]

[[patterns]]
id = "django/errors/handler"
category = "errors"
description = "Custom error handler"
sub_type = "error-handler"
confidence = 0.80
[patterns.match]
content_patterns = ["(?i)handler400|handler403|handler404|handler500", "(?i)class\\s+\\w+\\s*\\(\\s*(?:APIException|ValidationError)"]

[[patterns]]
id = "django/security/csrf"
category = "security"
description = "CSRF handling"
sub_type = "csrf"
confidence = 0.85
cwe_ids = [352]
[patterns.match]
content_patterns = ["(?i)@csrf_exempt", "(?i)@csrf_protect", "(?i)CsrfViewMiddleware", "(?i)\\{%\\s*csrf_token\\s*%\\}"]

[[patterns]]
id = "django/testing/testcase"
category = "testing"
description = "Django test class"
sub_type = "test-type"
confidence = 0.90
[patterns.match]
extends = ["TestCase", "TransactionTestCase", "LiveServerTestCase", "APITestCase"]
[patterns.learn]
group_by = "sub_type"
signal = "convention"

[[patterns]]
id = "django/logging/config"
category = "logging"
description = "Django logging configuration"
sub_type = "logging-config"
confidence = 0.80
[patterns.match]
content_patterns = ["(?i)LOGGING\\s*=\\s*\\{", "(?i)logging\\.getLogger\\s*\\("]

[[patterns]]
id = "django/perf/cache"
category = "performance"
description = "Django cache framework"
sub_type = "caching"
confidence = 0.85
[patterns.match]
content_patterns = ["(?i)from\\s+django\\.core\\.cache\\s+import", "(?i)@cache_page\\s*\\(", "(?i)cache\\.(?:get|set|delete)\\s*\\("]

[[patterns]]
id = "django/perf/celery"
category = "performance"
description = "Celery task queue"
sub_type = "task-queue"
confidence = 0.85
[patterns.match]
decorators = ["shared_task", "task", "periodic_task"]
