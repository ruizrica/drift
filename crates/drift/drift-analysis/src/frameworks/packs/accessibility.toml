[framework]
name = "accessibility-patterns"
display_name = "Accessibility Patterns"
languages = ["typescript", "javascript"]

[[patterns]]
id = "A11Y-ALT-TEXT-001"
category = "accessibility"
description = "Image alt text"
sub_type = "alt-text"
confidence = 0.85
[patterns.match]
content_patterns = [
    "(?i)<img[^>]+alt\\s*=",
    "(?i)alt\\s*=\\s*['\"`]\\w+",
    "(?i)aria-label\\s*=",
]

[[patterns]]
id = "A11Y-ALT-MISSING-001"
category = "accessibility"
description = "Missing alt text on image"
sub_type = "alt-text"
confidence = 0.75
cwe_ids = [1263]
[patterns.match]
content_patterns = ["(?i)<img(?![^>]*alt\\s*=)[^>]*>"]

[[patterns]]
id = "A11Y-ARIA-001"
category = "accessibility"
description = "ARIA role usage"
sub_type = "aria"
confidence = 0.80
[patterns.match]
content_patterns = [
    "(?i)role\\s*=\\s*['\"](?:button|navigation|dialog|alert|tab|menu|banner|main|complementary)",
    "(?i)aria-(?:label|describedby|hidden|expanded|selected|checked|disabled|live|atomic)",
]
[patterns.learn]
group_by = "sub_type"
signal = "convention"

[[patterns]]
id = "A11Y-FOCUS-001"
category = "accessibility"
description = "Focus management"
sub_type = "focus"
confidence = 0.80
[patterns.match]
content_patterns = [
    "(?i)tabIndex\\s*=", "(?i)tabindex\\s*=",
    "(?i)\\.focus\\s*\\(", "(?i)onFocus\\s*=",
    "(?i)onBlur\\s*=", "(?i)FocusTrap",
    "(?i)useFocusTrap", "(?i)autoFocus",
]

[[patterns]]
id = "A11Y-HEADING-001"
category = "accessibility"
description = "Heading hierarchy"
sub_type = "headings"
confidence = 0.75
[patterns.match]
content_patterns = ["(?i)<h[1-6]\\b"]
[patterns.learn]
group_by = "sub_type"
signal = "convention"

[[patterns]]
id = "A11Y-KEYBOARD-001"
category = "accessibility"
description = "Keyboard navigation support"
sub_type = "keyboard"
confidence = 0.80
[patterns.match]
content_patterns = [
    "(?i)onKeyDown\\s*=", "(?i)onKeyUp\\s*=",
    "(?i)onKeyPress\\s*=", "(?i)addEventListener\\s*\\(\\s*['\"]key",
    "(?i)event\\.key\\s*===", "(?i)e\\.key\\s*===",
]

[[patterns]]
id = "A11Y-SEMANTIC-HTML-001"
category = "accessibility"
description = "Semantic HTML element"
sub_type = "semantic-html"
confidence = 0.80
[patterns.match]
content_patterns = [
    "(?i)<(?:nav|main|article|section|aside|header|footer|figure|figcaption|details|summary|dialog|time)\\b",
]
[patterns.learn]
group_by = "sub_type"
signal = "convention"
