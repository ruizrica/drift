[framework]
name = "laravel"
display_name = "Laravel"
languages = ["php"]
[[framework.detect_by]]
import = "laravel"
[[framework.detect_by]]
import = "Illuminate"

[[patterns]]
id = "laravel/auth/gate"
category = "auth"
description = "Laravel Gate authorization"
sub_type = "gate"
confidence = 0.90
[patterns.match]
content_patterns = ["(?i)Gate::(?:allows|denies|check|authorize|define)\\s*\\(", "(?i)\\$this->authorize\\s*\\(", "(?i)@can\\s*\\("]
[patterns.learn]
group_by = "sub_type"
signal = "convention"

[[patterns]]
id = "laravel/auth/middleware"
category = "auth"
description = "Laravel auth middleware"
sub_type = "middleware"
confidence = 0.85
[patterns.match]
content_patterns = ["(?i)->middleware\\s*\\(\\s*['\"]auth", "(?i)->middleware\\s*\\(\\s*['\"]sanctum", "(?i)->middleware\\s*\\(\\s*['\"]verified"]

[[patterns]]
id = "laravel/data/eloquent-scope"
category = "data_access"
description = "Eloquent query scope"
sub_type = "scope"
confidence = 0.85
[patterns.match]
function_names = ["(?i)^scope[A-Z]"]
[patterns.learn]
group_by = "sub_type"
signal = "convention"

[[patterns]]
id = "laravel/data/migration"
category = "data_access"
description = "Database migration"
sub_type = "migration"
confidence = 0.90
[patterns.match]
content_patterns = ["(?i)Schema::(?:create|table|drop|rename)\\s*\\(", "(?i)\\$table->"]

[[patterns]]
id = "laravel/data/relationship"
category = "data_access"
description = "Eloquent relationship"
sub_type = "relationship"
confidence = 0.85
[patterns.match]
content_patterns = ["(?i)\\$this->(?:hasMany|hasOne|belongsTo|belongsToMany|morphTo|morphMany|morphOne)\\s*\\("]
[patterns.learn]
group_by = "sub_type"
signal = "convention"

[[patterns]]
id = "laravel/structural/service-provider"
category = "structural"
description = "Service provider registration"
sub_type = "service-provider"
confidence = 0.90
[patterns.match]
extends = ["ServiceProvider"]
[patterns.learn]
group_by = "sub_type"
signal = "convention"

[[patterns]]
id = "laravel/structural/facade"
category = "structural"
description = "Facade usage"
sub_type = "facade"
confidence = 0.80
[patterns.match]
content_patterns = ["(?i)(?:Cache|DB|Log|Auth|Event|Mail|Queue|Route|Storage|Validator)::"]

[[patterns]]
id = "laravel/config/env"
category = "config"
description = "Environment config access"
sub_type = "env"
confidence = 0.80
[patterns.match]
content_patterns = ["(?i)env\\s*\\(\\s*['\"]", "(?i)config\\s*\\(\\s*['\"]"]
[patterns.learn]
group_by = "sub_type"
signal = "convention"

[[patterns]]
id = "laravel/errors/exception"
category = "errors"
description = "Custom exception handler"
sub_type = "exception"
confidence = 0.85
[patterns.match]
content_patterns = ["(?i)class\\s+\\w+Exception\\s+extends", "(?i)render\\s*\\(.*\\$request.*\\$exception"]

[[patterns]]
id = "laravel/logging/channel"
category = "logging"
description = "Log channel usage"
sub_type = "log-channel"
confidence = 0.80
[patterns.match]
content_patterns = ["(?i)Log::(?:info|error|warning|debug|critical)\\s*\\(", "(?i)logger\\s*\\(\\s*\\)\\s*->"]

[[patterns]]
id = "laravel/security/validation"
category = "security"
description = "Form request validation"
sub_type = "form-request"
confidence = 0.85
[patterns.match]
extends = ["FormRequest"]
[patterns.learn]
group_by = "sub_type"
signal = "convention"

[[patterns]]
id = "laravel/security/csrf"
category = "security"
description = "CSRF protection"
sub_type = "csrf"
confidence = 0.85
cwe_ids = [352]
[patterns.match]
content_patterns = ["(?i)@csrf", "(?i)csrf_field\\s*\\(", "(?i)csrf_token\\s*\\("]

[[patterns]]
id = "laravel/testing/feature"
category = "testing"
description = "Feature test"
sub_type = "test-type"
confidence = 0.85
[patterns.match]
extends = ["TestCase"]
[patterns.learn]
group_by = "sub_type"
signal = "convention"

[[patterns]]
id = "laravel/perf/cache"
category = "performance"
description = "Cache usage"
sub_type = "caching"
confidence = 0.85
[patterns.match]
content_patterns = ["(?i)Cache::(?:get|put|remember|forever|forget)\\s*\\("]

[[patterns]]
id = "laravel/perf/queue"
category = "performance"
description = "Queue/Job dispatch"
sub_type = "queue"
confidence = 0.85
[patterns.match]
content_patterns = ["(?i)dispatch\\s*\\(\\s*new\\s+", "(?i)implements\\s+ShouldQueue"]
