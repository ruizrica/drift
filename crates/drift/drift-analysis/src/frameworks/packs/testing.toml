[framework]
name = "testing-patterns"
display_name = "Testing Patterns"
languages = ["typescript", "javascript", "python", "java", "csharp", "go", "rust", "ruby", "php", "kotlin"]

[[patterns]]
id = "TEST-COLOC-001"
category = "testing"
description = "Test co-located with source"
sub_type = "co-location"
confidence = 0.80
[patterns.match]
content_patterns = ["(?i)__tests__/|\\.(test|spec)\\.[jt]sx?$|\\.test\\.py$|_test\\.go$|_test\\.rs$"]
[patterns.learn]
group_by = "sub_type"
signal = "convention"

[[patterns]]
id = "TEST-DESCRIBE-001"
category = "testing"
description = "Test describe/context naming"
sub_type = "naming"
confidence = 0.80
[patterns.match]
content_patterns = [
    "(?i)describe\\s*\\(\\s*['\"]",
    "(?i)context\\s*\\(\\s*['\"]",
    "(?i)RSpec\\.describe",
]
[patterns.learn]
group_by = "sub_type"
signal = "convention"

[[patterns]]
id = "TEST-FIXTURE-001"
category = "testing"
description = "Test fixture/factory pattern"
sub_type = "fixtures"
confidence = 0.80
[patterns.match]
content_patterns = [
    "(?i)factory\\s*\\(", "(?i)fixture\\s*\\(",
    "(?i)@pytest\\.fixture", "(?i)FactoryBot",
    "(?i)createFactory\\s*\\(", "(?i)TestDataBuilder",
    "(?i)@DataJpaTest", "(?i)@TestConfiguration",
]

[[patterns]]
id = "TEST-MOCK-STYLE-001"
category = "testing"
description = "Mock/stub style"
sub_type = "mocking"
confidence = 0.80
[patterns.match]
imports = [
    "jest", "sinon", "testdouble", "nock",
    "unittest.mock", "pytest-mock",
    "Mockito", "MockBean", "mockall",
    "gomock", "testify/mock",
    "Moq", "NSubstitute", "FakeItEasy",
    "Prophecy", "Mockery",
]
[patterns.learn]
group_by = "sub_type"
signal = "convention"

[[patterns]]
id = "TEST-SETUP-001"
category = "testing"
description = "Test setup/teardown"
sub_type = "setup"
confidence = 0.75
[patterns.match]
content_patterns = [
    "(?i)beforeEach\\s*\\(", "(?i)afterEach\\s*\\(",
    "(?i)beforeAll\\s*\\(", "(?i)afterAll\\s*\\(",
    "(?i)setUp\\s*\\(", "(?i)tearDown\\s*\\(",
    "(?i)@Before\\b", "(?i)@After\\b",
    "(?i)@BeforeEach", "(?i)@AfterEach",
    "(?i)setup\\s+do\\b",
]

[[patterns]]
id = "TEST-STRUCTURE-AAA-001"
category = "testing"
description = "Arrange-Act-Assert test structure"
sub_type = "structure"
confidence = 0.70
[patterns.match]
content_patterns = [
    "(?i)//\\s*arrange|//\\s*act|//\\s*assert",
    "(?i)#\\s*arrange|#\\s*act|#\\s*assert",
    "(?i)given.*when.*then",
]
[patterns.learn]
group_by = "sub_type"
signal = "convention"
