[framework]
name = "express"
display_name = "Express.js"
languages = ["typescript", "javascript"]
[[framework.detect_by]]
import = "express"
[[framework.detect_by]]
dependency = "express"

[[patterns]]
id = "express/api/route-handler"
category = "api"
description = "Express route handler"
sub_type = "route-handler"
confidence = 0.90
[patterns.match]
content_patterns = [
    "(?i)(?:app|router)\\.(?:get|post|put|patch|delete|all)\\s*\\(\\s*['\"/]",
]
[patterns.learn]
group_by = "sub_type"
signal = "convention"

[[patterns]]
id = "express/api/middleware"
category = "api"
description = "Express middleware registration"
sub_type = "middleware"
confidence = 0.85
[patterns.match]
content_patterns = ["(?i)(?:app|router)\\.use\\s*\\("]
[patterns.learn]
group_by = "sub_type"
signal = "convention"

[[patterns]]
id = "express/auth/passport"
category = "auth"
description = "Passport.js authentication"
sub_type = "passport"
confidence = 0.90
[patterns.match]
imports = ["passport", "passport-local", "passport-jwt", "passport-google-oauth20"]

[[patterns]]
id = "express/auth/session"
category = "auth"
description = "Session-based auth"
sub_type = "session"
confidence = 0.85
[patterns.match]
imports = ["express-session", "connect-redis", "connect-mongo"]

[[patterns]]
id = "express/errors/handler"
category = "errors"
description = "Express error handler middleware"
sub_type = "error-handler"
confidence = 0.85
[patterns.match]
content_patterns = ["(?i)\\(\\s*err\\s*,\\s*req\\s*,\\s*res\\s*,\\s*next\\s*\\)"]
[patterns.learn]
group_by = "sub_type"
signal = "convention"

[[patterns]]
id = "express/security/helmet"
category = "security"
description = "Helmet security headers"
sub_type = "helmet"
confidence = 0.90
[patterns.match]
imports = ["helmet"]

[[patterns]]
id = "express/security/cors"
category = "security"
description = "CORS configuration"
sub_type = "cors"
confidence = 0.85
[patterns.match]
imports = ["cors"]

[[patterns]]
id = "express/logging/morgan"
category = "logging"
description = "Morgan HTTP logging"
sub_type = "http-logging"
confidence = 0.85
[patterns.match]
imports = ["morgan"]

[[patterns]]
id = "express/data/orm"
category = "data_access"
description = "ORM integration"
sub_type = "orm"
confidence = 0.85
[patterns.match]
imports = ["sequelize", "typeorm", "prisma", "@prisma/client", "mongoose", "knex", "objection"]
[patterns.learn]
group_by = "sub_type"
signal = "convention"

[[patterns]]
id = "express/testing/supertest"
category = "testing"
description = "HTTP test client"
sub_type = "http-testing"
confidence = 0.90
[patterns.match]
imports = ["supertest", "chai-http"]

[[patterns]]
id = "express/config/dotenv"
category = "config"
description = "Dotenv configuration"
sub_type = "env-loading"
confidence = 0.85
[patterns.match]
imports = ["dotenv"]

[[patterns]]
id = "express/perf/compression"
category = "performance"
description = "Response compression"
sub_type = "compression"
confidence = 0.85
[patterns.match]
imports = ["compression"]

[[patterns]]
id = "express/perf/rate-limit"
category = "performance"
description = "Rate limiting"
sub_type = "rate-limit"
confidence = 0.85
[patterns.match]
imports = ["express-rate-limit", "rate-limiter-flexible"]
