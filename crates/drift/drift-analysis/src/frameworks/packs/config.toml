[framework]
name = "config-patterns"
display_name = "Configuration Patterns"
languages = ["typescript", "javascript", "python", "java", "csharp", "go", "rust", "ruby", "php", "kotlin"]

[[patterns]]
id = "CFG-VALIDATE-001"
category = "config"
description = "Config validation"
sub_type = "validation"
confidence = 0.85
[patterns.match]
imports = ["envalid", "env-var", "convict", "pydantic-settings", "figment"]
[patterns.learn]
group_by = "sub_type"
signal = "convention"

[[patterns]]
id = "CFG-VALIDATE-CALL-001"
category = "config"
description = "Config validation call"
sub_type = "validation"
confidence = 0.80
[patterns.match]
content_patterns = [
    "(?i)cleanEnv\\s*\\(", "(?i)config\\.validate\\s*\\(",
    "(?i)@IsNotEmpty|@IsString|@IsNumber|@IsBoolean",
]

[[patterns]]
id = "CFG-FEATURE-FLAG-001"
category = "config"
description = "Feature flag usage"
sub_type = "feature-flags"
confidence = 0.85
[patterns.match]
imports = ["launchdarkly", "unleash", "flagsmith", "flipper", "split.io", "feature-flags"]

[[patterns]]
id = "CFG-FEATURE-FLAG-CHECK-001"
category = "config"
description = "Feature flag check"
sub_type = "feature-flags"
confidence = 0.80
[patterns.match]
content_patterns = [
    "(?i)isFeatureEnabled\\s*\\(", "(?i)feature[_-]?enabled\\s*\\(",
    "(?i)hasFeature\\s*\\(", "(?i)feature_flag",
    "(?i)FEATURE_", "(?i)FF_",
]
[patterns.learn]
group_by = "sub_type"
signal = "convention"

[[patterns]]
id = "CFG-ENV-NAMING-001"
category = "config"
description = "Environment variable naming"
sub_type = "env-naming"
confidence = 0.75
[patterns.match]
content_patterns = [
    "(?i)process\\.env\\.[A-Z_]+",
    "(?i)os\\.environ\\[", "(?i)os\\.getenv\\s*\\(",
    "(?i)env::var\\s*\\(", "(?i)viper\\.Get",
]
[patterns.learn]
group_by = "sub_type"
signal = "convention"

[[patterns]]
id = "CFG-DEFAULT-001"
category = "config"
description = "Default value pattern"
sub_type = "defaults"
confidence = 0.75
[patterns.match]
content_patterns = [
    "(?i)\\|\\|\\s*['\"]", "(?i)\\?\\?\\s*['\"]",
    "(?i)\\.get\\s*\\([^,]+,\\s*['\"]",
    "(?i)getenv\\s*\\([^,]+,\\s*['\"]",
    "(?i)unwrap_or\\s*\\(",
]

[[patterns]]
id = "CFG-REQUIRED-001"
category = "config"
description = "Required config enforcement"
sub_type = "required"
confidence = 0.80
[patterns.match]
content_patterns = [
    "(?i)throw.*missing.*(?:env|config|setting)",
    "(?i)raise.*missing.*(?:env|config|setting)",
    "(?i)required:\\s*true",
    "(?i)\\.expect\\s*\\(\\s*['\"]",
]

[[patterns]]
id = "CFG-ENV-DETECT-001"
category = "config"
description = "Environment variable detection"
sub_type = "environment"
confidence = 0.85
[patterns.match]
content_patterns = [
    "process\\.env\\.(?:NODE_ENV|APP_ENV)",
    "RAILS_ENV",
    "DJANGO_SETTINGS_MODULE",
    "ASPNETCORE_ENVIRONMENT",
    "os\\.(?:environ|getenv)\\s*\\(",
    "std::env::var\\s*\\(",
]
[patterns.learn]
group_by = "sub_type"
signal = "convention"
